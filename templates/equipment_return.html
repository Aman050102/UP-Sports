{% load static %}
<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>คืนอุปกรณ์กีฬา • UP-FMS</title>

    <link
      rel="icon"
      href="{% static 'img/Logo_of_University_of_Phayao.svg.png' %}"
      type="image/png"
    />
    <link rel="stylesheet" href="{% static 'assets/css/global.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/user_header.css' %}" />
    <link
      rel="stylesheet"
      href="{% static 'assets/css/user_equipment.css' %}"
    />
  </head>
  <body data-page="equipment">
    <header class="topbar">
      <div class="brand">
        <img
          src="{% static 'img/logoDSASMART.png' %}"
          alt="DSA"
          class="brand-logo"
        />
      </div>
      <nav class="mainmenu" aria-label="เมนูหลัก">
        <ul>
          <li><a class="toplink" href="{% url 'user_menu' %}">หน้าหลัก</a></li>
          <li>
            <a class="toplink" href="{% url 'user_equipment' %}">ไปหน้ายืม</a>
          </li>
        </ul>
      </nav>
      <div class="righttools">
        <span class="user-btn">{{ display_name }}</span>
        <form action="{% url 'logout' %}" method="post" class="logout-form">
          {% csrf_token %}
          <button type="submit" class="logout">ออกจากระบบ</button>
        </form>
      </div>
    </header>

    <main class="wrap">
      <div class="modebar" role="tablist" aria-label="โหมด">
        <button
          class="mode"
          aria-selected="false"
          onclick="location.href='{% url 'user_equipment' %}'"
        >
          ยืมอุปกรณ์
        </button>
        <button class="mode active" aria-selected="true">✓ คืนอุปกรณ์</button>
      </div>

      <section class="grid">
        <div class="panel form-card">
          <h2 class="panel-title">คืนอุปกรณ์</h2>

          <label class="field">
            <span class="field-label">อุปกรณ์</span>
            <div class="select-wrap">
              <select id="equipmentReturn">
                {% for e in equipments %}
                <option value="{{ e.name }}">{{ e.name }}</option>
                {% empty %}
                <option disabled>ยังไม่มีข้อมูลอุปกรณ์</option>
                {% endfor %}
              </select>
              <svg class="caret" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M6 9l6 6 6-6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
            </div>
          </label>

          <label class="field">
            <span class="field-label">จำนวนที่จะคืน</span>
            <div class="qty">
              <button type="button" class="qty-btn" data-delta="-1">−</button>
              <input
                id="qtyReturn"
                type="number"
                min="1"
                value="1"
                inputmode="numeric"
              />
              <button type="button" class="qty-btn" data-delta="1">+</button>
            </div>
          </label>

          <div class="actions">
            <button id="btnReturnConfirm" class="primary">ทำการคืน</button>
          </div>
        </div>

        <div class="panel stock-card">
          <div class="stock-head">
            <div>อุปกรณ์กีฬา</div>
            <div>คงเหลือ</div>
          </div>
          <ul class="stock-list" id="stockList">
            {% for e in equipments %}
            <li><span>{{ e.name }}</span><b>{{ e.stock }}</b></li>
            {% empty %}
            <li><span>—</span><b>0</b></li>
            {% endfor %}
          </ul>
        </div>
      </section>
    </main>

    <div class="sheet" id="sheetReturn" aria-hidden="true">
      <div class="sheet-card">
        <div class="sheet-title">ทำการคืน<br />เสร็จสิ้น</div>
        <div class="sheet-icon">✔</div>
      </div>
    </div>

    <script>
        window.BORROW_API = "{% url 'equip_borrow_api' %}";
        window.RETURN_API = "{% url 'equip_return_api' %}";
    </script>
    <script defer src="{% static 'js/equipment_return.js' %}"></script>
    
  </body>
</html>
