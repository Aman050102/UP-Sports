:root{
      --purple:#c08af6; --purple-100:#e9d8ff;
      --bg:#efe8f7; --card:#fff; --text:#1d1b22; --muted:#6a6570; --divider:#ece7f3;
      --shadow:0 10px 30px rgba(55,36,107,.12);
      --outdoor:#2e7d32; --badminton:#1565c0; --pool:#0f766e; --track:#ef6c00;
      --pill:#ead9ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:ui-sans-serif,system-ui,-apple-system,"Noto Sans Thai",Roboto,Arial,sans-serif;
      color:var(--text);
      background:linear-gradient(180deg,var(--purple) 0 90px, var(--bg) 90px 100%)
    }
    header{height:90px;display:flex;align-items:center;padding:0 18px;color:#fff;font-weight:900}
    .brand img{height:120px;object-fit:contain}
    main{min-height:calc(100% - 90px); padding:18px; display:grid; gap:18px}
    .card{background:var(--card); border-radius:22px; box-shadow:var(--shadow); padding:16px}

    .toolbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    input[type="date"], select, input[type="text"], button{
      padding:10px 12px; border:1px solid var(--divider); border-radius:12px; font-weight:600; background:#fff
    }
    button{cursor:pointer}

    .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border:1px solid var(--divider); border-radius:999px; background:#fff; font-weight:700
    }
    .chip small{opacity:.85; font-weight:800}
    .chip[data-k="all"]{background:var(--pill)}
    .chip[data-k="outdoor"]{color:var(--outdoor)}
    .chip[data-k="badminton"]{color:var(--badminton)}
    .chip[data-k="pool"]{color:var(--pool)}
    .chip[data-k="track"]{color:var(--track)}
    .chip.selected{outline:3px solid currentColor; outline-offset:2px}

    /* ===== แถวกราฟ ===== */
    .chart-row{
      display:grid; grid-template-columns: 1fr; gap:16px;
      align-items:center; justify-items:center;
    }
    /* ปุ่ม Export ชิดซ้าย */
    .chart-actions{
      width:100%;
      display:flex; gap:10px; flex-wrap:wrap;
      justify-content:flex-start;
    }
    /* ทำกราฟ “กลมและอยู่กลาง” */
    .chart-wrap{
      width:100%; display:flex; justify-content:center;
    }
    .chart-wrap canvas{
      width:360px;           /* กราฟเล็กลง */
      aspect-ratio:1/1;      /* สัดส่วนจานกลม/สี่เหลี่ยมตามชนิดกราฟ */
      max-width:90vw;
    }

    .stats{display:grid; grid-template-columns:repeat(5,1fr); gap:12px}
    .stat{background:#fff; border:1px solid var(--divider); border-radius:16px; padding:14px}
    .stat small{color:var(--muted)}
    .stat b{font-size:28px}

    .table-card{padding:0; overflow:hidden}
    .table-headband{
      background:#d4b5fa; color:#fff; font-weight:900;
      padding:14px 18px; border-top-left-radius:22px; border-top-right-radius:22px
    }
    .table-wrap{max-height:48vh; overflow:auto; border-top:1px solid var(--divider)}
    table{width:100%; border-collapse:collapse; background:#fff}
    thead th{position:sticky; top:0; background:#f3effa}
    th,td{padding:10px 12px; border-bottom:1px solid var(--divider); text-align:left; font-size:14px}
    tbody tr:hover{background:#faf9fc}

    .bigbox{
      background:#fff; border:1px solid var(--divider); border-radius:22px; padding:18px 22px;
      font-size:22px; font-weight:800; box-shadow:var(--shadow)
    }
    .bigbox b{font-size:40px; display:block; margin-top:4px}

    @media(max-width:1100px){
      .stats{grid-template-columns:repeat(2,1fr)}
    }
    @media(prefers-color-scheme:dark){
      :root{--bg:#1f1a29; --card:#221d2e; --text:#f6f1ff; --muted:#c7bfd3; --divider:#3a304b}
      thead th{background:#2d2540}
      .table-headband{background:#7b5bb0}
    }